# GDI

## Ссылки 
[Лекция GDI и GDI+](https://www.youtube.com/watch?v=VrneWOhqGVQ)  

## Обработка сообщений WM_PAINT
Если в контексте графического устройства установили выбранным собственный шрифт, то пока в контексте не установим исходный системный шрифт, удалить графический объект будет невозможно.  
Число графических объектов в исполняющемся процессе ограничено (примерно 10000 объектов).
```c++
#define ARRAYSIZE(a) (sizeof(a) / sizeof(*(a)))

LRESULT CALLBACK WndProc(HWND hWnd, UINT uMsg, WPARAM wParam, LPARAM lParam) {

  switch (uMsg) {
    case WM_PAINT: {
      PAINTSTRUCT ps;
      HDC dc = BeginPaint(hWnd, &ps);
      OnPaint(hWnd);
      EndPaint(hWnd, &ps);
    }
    break;
  }

}

void OnPaint(HDC hdc) {

  // В контексте устройства устанавливаем выбранным новый шрифт и получаем предыдущий шрифт.
  HGDIOBJ oldFont = SelectObject(hdc, newFont);

  // Выводим текст заданным цветом и выбранным шрифтом.
  SetTextColor(hdc, RGB(51, 120, 27));
  TCHAR text[] = "привет";
  //TextOut(hdc, 0, 0, text, strlen(text));
  //TextOut(hdc, 0, 0, text, sizeof(text)/sizeof(*text));
  TextOut(hdc, 0, 0, text, ARRAYSIZE(text));  

  // Восстанавливаем в контексте исходный шрифт, наш шрифт освобождается.
  SelectObject(hdc, oldFont);

  // Удаляем графический объект шрифт.
  DeleteObject(hFont1);

}
```
